<?xml version="1.0" encoding="utf-8" ?>
<sqlMap namespace="Rld.Acs.Repository.Mybatis.MsSql" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://ibatis.apache.org/mapping">

  <alias>
    <typeAlias alias="Customer" type="Rld.Acs.Model.Customer" />
  </alias>

  <resultMaps>
    <resultMap id="CustomerResult" class="Rld.Acs.Model.Customer">
      <result property="CustomerId" column="CustomerId" />
      <result property="FirstName" column="FirstName" />
      <result property="LastName" column="LastName" />
      <result property="MSIDSN" column="MSIDSN" />
      <result property="Balance" column="Balance" />
      <result property="ResigterDateTime" column="ResigterDateTime" />
      <result property="Address" column="Address" />
    </resultMap>
  </resultMaps>

  <statements>
    <select id="Customer.GetByKey" parameterClass="Int64" resultMap="CustomerResult">
      SELECT * 
      FROM Customer 
      where CustomerId =  #value#
    </select>
    <insert id="Customer.Insert" parameterClass="Customer">
      INSERT INTO Customer
      (FirstName,LastName,MSIDSN,Balance,ResigterDateTime,Address)
      VALUES(#FirstName#,#LastName#,#MSIDSN#,#Balance#,#ResigterDateTime#,#Address#)
      <selectKey resultClass="int" type="post" property="CustomerId" >
        select @@IDENTITY as value
      </selectKey>
    </insert>
    <update id="Customer.Update" parameterClass="Customer">
      UPDATE Customer
      SET FirstName=#FirstName#,LastName=#LastName#,MSIDSN=#MSIDSN#,Balance=#Balance#,ResigterDateTime=#ResigterDateTime#,Address=#Address#
      WHERE CustomerId = #CustomerId#
    </update>
    <delete id="Customer.Delete"  parameterClass="Int64">
      DELETE FROM Customer
      where CustomerId =  #value#
    </delete>

    <select id="Customer.Query" parameterClass="Hashtable" resultMap="CustomerResult">
      SELECT *
      FROM Customer
      where 1=1
      <isNotEmpty prepend="and" property="FirstName">
        FirstName=#FirstName#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="LastName">
        LastName=#LastName#
      </isNotEmpty>
      <isNotEmpty prepend="and" property="MSIDSN">
        MSIDSN=#MSIDSN#
      </isNotEmpty>
    </select>
  </statements>
</sqlMap>
